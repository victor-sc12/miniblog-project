{% extends "base.html" %}
{% block title %}Home{% endblock title %}
{% block contenido %}

<form action="" method="get">
    <input type="text" name="query_search" placeholder="Find by song, album or author", value="{% if query_search %}{{query_search}}{% endif %}">
    <button type="submit">buscar</button>
</form>

{% for musica in musicas %}
    <h3>{{musica.nombre}}</h3>
    <p>{{musica.album.nombre}} -- <strong>{{musica.album.artista.nombre}}</strong> -- Rating promedio: {{musica.avg_rating}}</p>
    
    <ul>
        {% for resenia in musica.resenias_list %}
        <li>{{resenia.title}} | {{resenia.calificacion}}</li>
        {% empty %}
        <li>No hay ninguna por el momento.</li>
        {% endfor %}
    </ul>   
    
    <p><a href="{% url 'detail_view' musica.slug %}">Ver mas</a> |
    {% if not musica.has_review %}<a href="{% url 'add_resenia' musica.slug %}">AÃ±adir resenia</a>
    {% else %}<a href="{% url 'update_resenia' musica.slug %}">Actualizar resenia</a>{% endif %}</p>

{% empty %}
    <p>No hay canciones :/</p>
{% endfor %}

<!-- paginator -->
{% if musicas.has_previous %}<a href="?page={{musicas.previous_page_number}}">previous page</a>{% endif %}
<span>page {{musicas.number}} of {{musicas.paginator.num_pages}}</span>
{% if musicas.has_next %}<a href="?page={{musicas.next_page_number}}">next page</a>{% endif %}

{% endblock contenido %}